<!DOCTYPE html><!--[if lt IE 7]>      <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:og="http://ogp.me/ns#"
    xmlns:fb="https://www.facebook.com/2008/fbml" class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="description" content="Artificial Neural Network library implemented in Python">
        <meta name="viewport" content="width=device-width">
        <title>neupy.optimizations.wolfe module &mdash; NeuPy</title>
            <link rel="stylesheet" href="../_static/normalize.css" type="text/css">
            <link rel="stylesheet" href="../_static/sphinx.css" type="text/css">
            <link rel="stylesheet" href="../_static/main.css" type="text/css">
            <link rel="stylesheet" href="../_static/flat.css" type="text/css">
            <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
            <link rel="stylesheet" href="../_static/font-awesome.min.css" type="text/css">
        <link rel="shortcut icon" href="../_static/favicon.ico" /><!-- Load modernizr and JQuery -->
        <script src="../_static/vendor/modernizr-2.6.2.min.js"></script>
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="../_static/vendor/jquery-1.8.2.min.js"><\/script>')</script>
        <script src="../_static/plugins.js"></script>
        <script src="../_static/main.js"></script>
        <link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.html" /><script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script><script type="text/javascript" src="../_static/underscore.js"></script><script type="text/javascript" src="../_static/doctools.js"></script><script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/javascript" src="../_static/disqus.js"></script><script type="text/javascript" src="../_static/js/google_analytics.js"></script><script type="text/javascript" src="../_static/js/script.js"></script><script type="text/javascript" src="../_static/js/copybutton.js"></script>

    <script type="text/javascript">
        $(document).ready(function () {
            // Scroll to content if on small screen
            if (screen.width < 480)
            {
                $(document).scrollTop(document.getElementsByTagName("article")[0].offsetTop - 44);
            }
        });
    </script>
<style media="screen" type="text/css">
    #fork_me { display: none; }
    #fork_me img { position: fixed; top: 0; right: 0; border: 0; width: 130px; }
    @media only screen and (min-width: 768px) { #fork_me { display: inline; } }

    .docutils { width: 100%; }
    .docutils td { padding: 10px; }
    .section { word-wrap:break-word; }
    .descname { font-weight: bold; }
    .highlight-python + .figure { margin-top: 20px; }
    .dataframe { text-align: center !important; width: 100%; margin: 10px 0 10px 0; }
    .dataframe td { padding: 5px; }

    .math .gd { color: #000 !important; } /* Generic.Deleted */
    .math .m { color: #000 !important; } /* Literal.Number */
    .math .s { color: #000 !important; } /* Literal.String */
    .math .mf { color: #000 !important; } /* Literal.Number.Float */
    .math .mh { color: #000 !important; } /* Literal.Number.Hex */
    .math .mi { color: #000 !important; } /* Literal.Number.Integer */
    .math .mo { color: #000 !important; } /* Literal.Number.Oct */
    .math .sc { color: #000 !important; } /* Literal.String.Char */
    .math .s2 { color: #000 !important; } /* Literal.String.Double */
    .math .si { color: #000 !important; } /* Literal.String.Interpol */
    .math .sx { color: #000 !important; } /* Literal.String.Other */
    .math .s1 { color: #000 !important; } /* Literal.String.Single */
    .math .ss { color: #000 !important; } /* Literal.String.Symbol */
    .math .il { color: #000 !important; } /* Literal.Number.Integer.Long */
</style></head>
    <body role="document">
        <!--[if lt IE 7]>
            <p class="chromeframe">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> or <a href="http://www.google.com/chromeframe/?redirect=true">activate Google Chrome Frame</a> to improve your experience.</p>
        <![endif]-->

      <div id="container"><header role="banner">
            <hgroup>
              <h1><a href="../pages/home.html">NeuPy</a></h1><h2>Neural Networks in Python</h2></hgroup>
          </header>
      <nav role="navigation">
            <ul><li class="main-nav">
                  <a href="../pages/home.html">Home</a>
                </li>
              <li class="main-nav">
                  <a href="../page1.html">Articles</a>
                </li>
              <li class="main-nav">
                  <a href="../pages/documentation.html">Documentation</a>
                </li>
              <li class="main-nav">
                  <a href="../pages/installation.html">Installation</a>
                </li>
              </ul>
          </nav><div class="main-container" role="main"><div class="main wrapper body clearfix"><article>
    <div class="section" id="module-neupy.optimizations.wolfe">
<span id="neupy-optimizations-wolfe-module"></span><h1>neupy.optimizations.wolfe module</h1>
<p>Main source code from Pylearn2 library:
<a class="reference external" href="https://github.com/lisa-lab/pylearn2/blob/master/pylearn2/optimization/linesearch.py">https://github.com/lisa-lab/pylearn2/blob/master/pylearn2/optimization/linesearch.py</a></p>
<dl class="function">
<dt id="neupy.optimizations.wolfe.cubic_minimizer">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">cubic_minimizer</span><span class="sig-paren">(</span><em>x_a</em>, <em>y_a</em>, <em>y_prime_a</em>, <em>x_b</em>, <em>y_b</em>, <em>x_c</em>, <em>y_c</em>, <em>bound_size_ratio=0.2</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Finds the minimizer for a cubic polynomial that goes
through the points (x_a, y_a), (x_b, y_b), and (x_c, y_c) with
derivative at <span class="docutils literal"><span class="pre">x_a</span></span> of y_prime_a. If no minimizer can be
found return <span class="docutils literal"><span class="pre">NaN</span></span>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x_a</strong> : float or theano variable</p>
<blockquote>
<div><p>First point <span class="docutils literal"><span class="pre">a</span></span> in the <span class="docutils literal"><span class="pre">x</span></span> axis.</p>
</div></blockquote>
<p><strong>y_a</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y</span></span> at point <span class="docutils literal"><span class="pre">a</span></span>.</p>
</div></blockquote>
<p><strong>y_prime_a</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y'</span></span> (<span class="docutils literal"><span class="pre">y</span></span> derivative) at
point <span class="docutils literal"><span class="pre">a</span></span>.</p>
</div></blockquote>
<p><strong>x_b</strong> : float or theano variable</p>
<blockquote>
<div><p>Second point <span class="docutils literal"><span class="pre">b</span></span> in the <span class="docutils literal"><span class="pre">x</span></span> axis.</p>
</div></blockquote>
<p><strong>y_b</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y</span></span> at point <span class="docutils literal"><span class="pre">b</span></span>.</p>
</div></blockquote>
<p><strong>x_c</strong> : float or theano variable</p>
<blockquote>
<div><p>Third point <span class="docutils literal"><span class="pre">c</span></span> in the <span class="docutils literal"><span class="pre">x</span></span> axis.</p>
</div></blockquote>
<p><strong>y_c</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y</span></span> at point <span class="docutils literal"><span class="pre">c</span></span>.</p>
</div></blockquote>
<p><strong>bound_size_ratio</strong> : float</p>
<blockquote>
<div><p>Value control acceptable bounds for interpolation. If value
close to one of the points interpolation result will be ignored.
The bigger ratio, the more likely to reject interpolation.
Value needs to be between <span class="docutils literal"><span class="pre">0</span></span> and <span class="docutils literal"><span class="pre">1</span></span>. Defaults to <span class="docutils literal"><span class="pre">0.1</span></span>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">object</p>
<blockquote class="last">
<div><p>Theano variable that after evaluation is equal to
point <span class="docutils literal"><span class="pre">x</span></span> which is minimizer for cubic function.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neupy.optimizations.wolfe.line_search">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">line_search</span><span class="sig-paren">(</span><em>f</em>, <em>f_deriv</em>, <em>maxiter=20</em>, <em>c1=0.0001</em>, <em>c2=0.9</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Find <span class="docutils literal"><span class="pre">x</span></span> that satisfies strong Wolfe conditions.
<span class="docutils literal"><span class="pre">x</span> <span class="pre">&gt;</span> <span class="pre">0</span></span> is assumed to be a descent direction.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>f</strong> : callable f(x)</p>
<blockquote>
<div><p>Objective scalar function.</p>
</div></blockquote>
<p><strong>f_deriv</strong> : callable f&#8217;(x)</p>
<blockquote>
<div><p>Objective function derivative (can be None)</p>
</div></blockquote>
<p><strong>maxiter</strong> : int</p>
<blockquote>
<div><p>Maximum number of iterations.</p>
</div></blockquote>
<p><strong>c1</strong> : float</p>
<blockquote>
<div><p>Parameter for Armijo condition rule.</p>
</div></blockquote>
<p><strong>c2</strong> : float</p>
<blockquote>
<div><p>Parameter for curvature condition rule.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Theano object</p>
<blockquote class="last">
<div><p>Value <span class="docutils literal"><span class="pre">x</span></span> that satisfies strong Wolfe conditions and
minimize function <span class="docutils literal"><span class="pre">f</span></span>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Uses the line search algorithm to enforce strong Wolfe
conditions.  See Wright and Nocedal, &#8216;Numerical Optimization&#8217;,
1999, pg. 59-60.
For the zoom phase it uses an algorithm by [...].</p>
</dd></dl>

<dl class="function">
<dt id="neupy.optimizations.wolfe.quadratic_minimizer">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">quadratic_minimizer</span><span class="sig-paren">(</span><em>x_a</em>, <em>y_a</em>, <em>y_prime_a</em>, <em>x_b</em>, <em>y_b</em>, <em>bound_size_ratio=0.1</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Finds the minimizer for a quadratic polynomial that
goes through the points (x_a, y_a), (x_b, y_b) with derivative
at x_a of y_prime_a.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x_a</strong> : float or theano variable</p>
<blockquote>
<div><p>Left point <span class="docutils literal"><span class="pre">a</span></span> in the <span class="docutils literal"><span class="pre">x</span></span> axis.</p>
</div></blockquote>
<p><strong>y_a</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y</span></span> at point <span class="docutils literal"><span class="pre">a</span></span>.</p>
</div></blockquote>
<p><strong>y_prime_a</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y'</span></span> (<span class="docutils literal"><span class="pre">y</span></span> derivative) at
point <span class="docutils literal"><span class="pre">a</span></span>.</p>
</div></blockquote>
<p><strong>x_b</strong> : float or theano variable</p>
<blockquote>
<div><p>Right point <span class="docutils literal"><span class="pre">a</span></span> in the <span class="docutils literal"><span class="pre">x</span></span> axis.</p>
</div></blockquote>
<p><strong>y_b</strong> : float or theano variable</p>
<blockquote>
<div><p>Output from function <span class="docutils literal"><span class="pre">y</span></span> at point <span class="docutils literal"><span class="pre">b</span></span>.</p>
</div></blockquote>
<p><strong>bound_size_ratio</strong> : float</p>
<blockquote>
<div><p>Value control acceptable bounds for interpolation. If value
close to one of the points interpolation result will be ignored.
The bigger ratio, the more likely to reject interpolation.
Value needs to be between <span class="docutils literal"><span class="pre">0</span></span> and <span class="docutils literal"><span class="pre">1</span></span>. Defaults to <span class="docutils literal"><span class="pre">0.1</span></span>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">object</p>
<blockquote class="last">
<div><p>Theano variable that after evaluation is equal to
point <span class="docutils literal"><span class="pre">x</span></span> which is minimizer for quadratic function.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neupy.optimizations.wolfe.sequential_and">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">sequential_and</span><span class="sig-paren">(</span><em>*conditions</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Use <span class="docutils literal"><span class="pre">and</span></span> operator between all conditions. Function is just
a syntax sugar that make long Theano logical conditions looks
less ugly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>*conditions</strong></p>
<blockquote class="last">
<div><p>Conditions that returns <span class="docutils literal"><span class="pre">True</span></span> or <span class="docutils literal"><span class="pre">False</span></span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neupy.optimizations.wolfe.sequential_or">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">sequential_or</span><span class="sig-paren">(</span><em>*conditions</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Use <span class="docutils literal"><span class="pre">or</span></span> operator between all conditions. Function is just
a syntax sugar that make long Theano logical conditions looks
less ugly.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>*conditions</strong></p>
<blockquote class="last">
<div><p>Conditions that returns <span class="docutils literal"><span class="pre">True</span></span> or <span class="docutils literal"><span class="pre">False</span></span></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="neupy.optimizations.wolfe.zoom">
<span class="descclassname">neupy.optimizations.wolfe.</span><span class="descname">zoom</span><span class="sig-paren">(</span><em>x_low</em>, <em>x_high</em>, <em>y_low</em>, <em>y_high</em>, <em>y_deriv_low</em>, <em>f</em>, <em>f_deriv</em>, <em>y0</em>, <em>y_deriv_0</em>, <em>c1</em>, <em>c2</em>, <em>maxiter=10</em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/itdxer/neupy/tree/master/neupy/optimizations/wolfe.py"><span class="viewcode-link">[source]</span></a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>x_low</strong> : float</p>
<blockquote>
<div><p>Step size</p>
</div></blockquote>
<p><strong>x_high</strong> : float</p>
<blockquote>
<div><p>Step size</p>
</div></blockquote>
<p><strong>y_low</strong> : float</p>
<blockquote>
<div><p>Value of f at x_low</p>
</div></blockquote>
<p><strong>y_high</strong> : float</p>
<blockquote>
<div><p>Value of f at x_high</p>
</div></blockquote>
<p><strong>y_deriv_low</strong> : float</p>
<blockquote>
<div><p>Value of derivative at x_low</p>
</div></blockquote>
<p><strong>f</strong> : callable f(x)</p>
<blockquote>
<div><p>Generates computational graph</p>
</div></blockquote>
<p><strong>f_deriv</strong> : callable f&#8217;(x)</p>
<blockquote>
<div><p>Generates computational graph</p>
</div></blockquote>
<p><strong>y0</strong> : float</p>
<blockquote>
<div><p>Value of f for <span class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">0</span></span></p>
</div></blockquote>
<p><strong>y_deriv_0</strong> : float</p>
<blockquote>
<div><p>Value of the derivative for <span class="docutils literal"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">0</span></span></p>
</div></blockquote>
<p><strong>c1</strong> : float</p>
<blockquote>
<div><p>Parameter for Armijo condition rule.</p>
</div></blockquote>
<p><strong>c2</strong> : float</p>
<blockquote class="last">
<div><p>Parameter for curvature condition rule.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Part of the optimization algorithm in <cite>scalar_search_wolfe2</cite>.</p>
</dd></dl>

</div>

    <div class="postmeta">
        
        
        
        </div></article><aside class="sidebar"><section><div class="widget">
    <h1>Recent Posts</h1>
    <ul><li>
            <a href="../2015/09/21/password_recovery.html">Password recovery</a>
        </li><li>
            <a href="../2015/09/20/discrete_hopfield_network.html">Discrete Hopfiel Network</a>
        </li><li>
            <a href="../2015/07/04/boston_house_prices_dataset.html">Boston house-prices dataset</a>
        </li><li>
            <a href="../2015/07/04/visualize_backpropagation_algorithms.html">Visualize Algorithms based on the Backpropagation</a>
        </li></ul>
</div>
</section><section><div class="widget">
    <h1>Cheat sheet</h1>
    <ul>
        <li><a href="../docs/algorithms.html#algorithms">Algorithms</a></li>
        <li><a href="../docs/algorithms.html#layers">Layers</a></li>
        <li><a href="../docs/algorithms.html#error-functions">Error functions</a></li>
    </ul>
</div></section><section><div class="widget">
    <h1>Installation</h1>
    <div class="highligh-bash">
        <div class="highlight">
            <pre>pip install neupy</pre>
        </div>
    </div>
    <p>Read more in <a href="../pages/documentation.html">Documentation</a>.</p>
    <p>Old documentations you can find <a href="../pages/versions.html">here</a>.</p>
</div></section><section><div class="widget" id="searchbox" role="search">
    <h1><a href="#searchbox">Search</a></h1>
    <form action="../search.html" method="get">
        <input type="text" name="q" />
        <button type="submit"><span class="fa fa-search"></span></button>
    </form>
</div></section></aside></div> <!-- #main --></div> <!-- #main-container -->

        <div class="footer-container" role="contentinfo"><footer class="wrapper">&copy; Copyright 2015 - 2016, Yurii Shevchuk. Powered by <a href="http://www.tinkerer.me/">Tinkerer</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.</footer>
    <a id="fork_me" href="http://github.com/itdxer/neupy">
        <img alt="Fork me" src="../_static/img/github-fork-green.png" />
    </a></div> <!-- footer-container -->

      </div> <!--! end of #container --><script type="text/javascript">    var disqus_shortname = "neupy";    disqus_count();</script><!--[if lt IE 7 ]>
          <script src="//ajax.googleapis.com/ajax/libs/chrome-frame/1.0.3/CFInstall.min.js"></script>
          <script>window.attachEvent('onload',function(){CFInstall.check({mode:'overlay'})})</script>
        <![endif]-->
    </body>
</html>